# Migration `20200616193101-instagram_copy`

This migration has been generated by yeonho Park at 6/16/2020, 7:31:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `instagram_copy`.`User` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,`profile` varchar(191) NOT NULL  ,`userId` varchar(191) NOT NULL  ,`userPw` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`Post` (
`authorId` int NOT NULL ,`content` varchar(191) NOT NULL  ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`Comment` (
`authorId` int NOT NULL ,`content` varchar(191) NOT NULL  ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`postId` int  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`HashTag` (
`content` varchar(191) NOT NULL  ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`Image` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`postId` int NOT NULL ,`src` varchar(191) NOT NULL  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`__FollowerFollowing` (
`A` int NOT NULL ,`B` int NOT NULL 
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`__likeToPost` (
`A` int NOT NULL ,`B` int NOT NULL 
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`__HashTagToPost` (
`A` int NOT NULL ,`B` int NOT NULL 
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.userId` ON `instagram_copy`.`User`(`userId`)

CREATE UNIQUE INDEX `__FollowerFollowing_AB_unique` ON `instagram_copy`.`__FollowerFollowing`(`A`,`B`)

CREATE  INDEX `__FollowerFollowing_B_index` ON `instagram_copy`.`__FollowerFollowing`(`B`)

CREATE UNIQUE INDEX `__likeToPost_AB_unique` ON `instagram_copy`.`__likeToPost`(`A`,`B`)

CREATE  INDEX `__likeToPost_B_index` ON `instagram_copy`.`__likeToPost`(`B`)

CREATE UNIQUE INDEX `__HashTagToPost_AB_unique` ON `instagram_copy`.`__HashTagToPost`(`A`,`B`)

CREATE  INDEX `__HashTagToPost_B_index` ON `instagram_copy`.`__HashTagToPost`(`B`)

ALTER TABLE `instagram_copy`.`Post` ADD FOREIGN KEY (`authorId`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`Comment` ADD FOREIGN KEY (`authorId`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`Comment` ADD FOREIGN KEY (`postId`) REFERENCES `instagram_copy`.`Post`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`Image` ADD FOREIGN KEY (`postId`) REFERENCES `instagram_copy`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__FollowerFollowing` ADD FOREIGN KEY (`A`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__FollowerFollowing` ADD FOREIGN KEY (`B`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__likeToPost` ADD FOREIGN KEY (`A`) REFERENCES `instagram_copy`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__likeToPost` ADD FOREIGN KEY (`B`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__HashTagToPost` ADD FOREIGN KEY (`A`) REFERENCES `instagram_copy`.`HashTag`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`__HashTagToPost` ADD FOREIGN KEY (`B`) REFERENCES `instagram_copy`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200616193101-instagram_copy
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,64 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource mysql {
+  provider = "mysql"
+  url      = env("DATABASE_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+// schema 정의
+
+model User {
+  id        Int       @id @default(autoincrement())
+  name      String
+  userId    String    @unique
+  userPw    String
+  profile   String
+  createdAt DateTime  @default(now())
+  myPosts   Post[]    @relation("_PostToUser")
+  comments  Comment[] @relation("_CommentToUser")
+  follower  User[]    @relation("_FollowerFollowing", references: [id]) // 나를 등록한 사람
+  following User[]    @relation("_FollowerFollowing", references: [id]) // 내가 등록한 사람
+  likePosts Post[]    @relation("_likeToPost")
+}
+
+model Post {
+  id          Int       @id @default(autoincrement())
+  content     String
+  createdAt   DateTime  @default(now())
+  author      User      @relation("_PostToUser", fields: [authorId], references: [id])
+  authorId    Int
+  comments    Comment[] @relation("_CommentToPost")
+  hashTags    HashTag[] @relation("_HashTagToPost", references: [id])
+  images      Image[]   @relation("_ImageToPost")
+  likeAuthors User[]    @relation("_likeToPost")
+}
+
+model Comment {
+  id        Int      @id @default(autoincrement())
+  content   String
+  createdAt DateTime @default(now())
+  author    User     @relation("_CommentToUser", fields: [authorId], references: [id])
+  authorId  Int
+  Post      Post?    @relation("_CommentToPost", fields: [postId], references: [id])
+  postId    Int?
+}
+
+model HashTag {
+  id        Int      @id @default(autoincrement())
+  content   String
+  createdAt DateTime @default(now())
+  posts     Post[]   @relation("_HashTagToPost", references: [id])
+}
+
+model Image {
+  id        Int      @id @default(autoincrement())
+  src       String
+  createdAt DateTime @default(now())
+  post      Post     @relation("_ImageToPost", fields: [postId], references: [id])
+  postId    Int
+}
```


