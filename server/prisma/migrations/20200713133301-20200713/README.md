# Migration `20200713133301-20200713`

This migration has been generated by yeonho Park at 7/13/2020, 1:33:01 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `instagram_copy`.`Room` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`name` varchar(191) NOT NULL  ,`ownerId` int NOT NULL ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `instagram_copy`.`Chat` (
`content` varchar(191) NOT NULL  ,`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,`id` int NOT NULL  AUTO_INCREMENT,`roomId` int  ,`userId` int  ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `instagram_copy`.`Room` ADD FOREIGN KEY (`ownerId`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`Chat` ADD FOREIGN KEY (`roomId`) REFERENCES `instagram_copy`.`Room`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `instagram_copy`.`Chat` ADD FOREIGN KEY (`userId`) REFERENCES `instagram_copy`.`User`(`id`) ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200627082114-20200627..20200713133301-20200713
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource mysql {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -12,19 +12,21 @@
 // schema 정의
 model User {
-  id         Int          @id @default(autoincrement())
-  name       String
-  userId     String       @unique
-  userPw     String
-  profile    String
-  createdAt  DateTime     @default(now())
-  myPosts    Post[]       @relation("_PostToUser")
-  comments   Comment[]    @relation("_CommentToUser")
-  follower   User[]       @relation("followerFollowing", references: [id]) // 나를 등록한 사람
-  following  User[]       @relation("followerFollowing", references: [id]) // 내가 등록한 사람
-  likedPosts likeToPost[]
+  id             Int          @id @default(autoincrement())
+  name           String
+  userId         String       @unique
+  userPw         String
+  profile        String
+  createdAt      DateTime     @default(now())
+  myPosts        Post[]       @relation("_PostToUser")
+  comments       Comment[]    @relation("_CommentToUser")
+  follower       User[]       @relation("followerFollowing", references: [id]) // 나를 등록한 사람
+  following      User[]       @relation("followerFollowing", references: [id]) // 내가 등록한 사람
+  likedPosts     likeToPost[]
+  possessedRooms Room[]       @relation("_RoomOwner")
+  chats          Chat[]       @relation("_ChatToUser")
 }
 model Post {
   id        Int             @id @default(autoincrement())
@@ -62,8 +64,27 @@
   post      Post     @relation("_ImageToPost", fields: [postId], references: [id])
   postId    Int
 }
+model Room {
+  id        Int      @id @default(autoincrement())
+  name      String
+  owner     User     @relation("_RoomOwner", fields: [ownerId], references: [id])
+  ownerId   Int
+  createdAt DateTime @default(now())
+  chats     Chat[]   @relation("_ChatToRoom")
+}
+
+model Chat {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  content   String
+  room      Room?    @relation("_ChatToRoom", fields: [roomId], references: [id])
+  roomId    Int?
+  user      User?    @relation("_ChatToUser", fields: [userId], references: [id])
+  userId    Int?
+}
+
 // user[] <--> post[]
 model likeToPost {
   post      Post     @relation(fields: [postId], references: [id])
   postId    Int
```


